{% extends 'base.html' %}
{% load static %}

{% block title %}
- Közösségi oldal, tanároknak!
{% endblock title%}

{% block head-content %}

<style>
    body{
        background: #F0F0F0;
    }

    .message_box{
        padding-top: 5vw;
        display: block;
    }

    .row {
        max-width: 800px;
        margin: auto;
    }

    .content{
        border: 2px solid var(--dark-green);
        padding: 20px;
        background: white;
    }
    
    .message_text{
        min-height: 30vh;
        width: 100%;
        resize: none;
        border: none;
    }

    .reply{
        height: 60px;
        width: 100%;
        margin-top: 20px;
    }

    .reply button {
        margin: 0px;
        height: 60px;
        float: right;
        width: 100px;
        border: 3px solid var(--dark-green);
        color: var(--dark-green);
        font-weight: bold;
        transition: 0.5s;
        border-radius: 5px;
    }

    .reply button:hover{
        background-color: var(--dark-green);
        color: white;
    }

    .title{
        background-color: var(--dark-green);
        color: white;
        margin-bottom: 0px;
        padding: 10px;
        width: 100%;
        padding-left: 21px;
        min-height: 80px;
        padding-top: 0px;
        display: inline-block;
    }

    .title input {
        width: calc(100% - 10px);
        height: 60px;
        margin-top: 20px;
        font-size: 30px;
        background-color: rgba(255, 255, 255, 0.03);
        border: none;
        padding: 0px 10px;
        color: white;
    }

    .target_holder{
        margin-top: 10px;
        width: 100%;
        height: 30px;
        text-align: right;
        padding-right: 10px;;
    }

    .target_holder a {
        color: white;
        font-weight: bold;
    }

    @media screen and (max-width: 800px) {
        .msg_title{
        font-size: 20px;
        }
    }
</style>

{% endblock head-content %}

{% block content %}

{% include 'main/navbar.html' %}

<div class="container" style="margin-top: 80px;" id="send_msg_app">
    
    <div class="row message_box">
        <div class="title">
            <input type="text" id="msg_title" placeholder="Cím">
            <div class="target_holder">
                Címzett: <a href="{% url 'openUserProfile' target.id %}">{{ target.username }}</a>
            </div>
        </div>
        <div class="content">
            <textarea id="contentText" class="message_text" cols="30" rows="10"></textarea>
            <div class="reply">
                <button v-on:click="sendMessage()">Küldés</button>
            </div>
        </div>
    </div>


    <input type="hidden" id="target_id" value="{{ target.id }}">

    <input type="hidden" id="send_url" value="{% url 'send_this_msg' target.id %}">


</div>
{% endblock content %}

{% block scripts %}

<script>

let send_messages_app = new Vue({
    delimiters: ["[[", "]]"],
    el: '#send_msg_app',
    data: {
        incoming:true
    },
    mounted(){
    },
    methods: {
        sendMessage: function(){
            let url = document.getElementById("send_url").value;

            let data = {
                "target":document.getElementById("target_id").value,
                "title":document.getElementById("msg_title").value,
                "content":document.getElementById("contentText").value
            }

            axios.defaults.xsrfCookieName = 'csrftoken';
            axios.defaults.xsrfHeaderName = "X-CSRFTOKEN";
            console.log(JSON.stringify(data));
            axios.post(url, JSON.stringify(data) ).then(response => this.articleId = response.data.id);

        }
    }
});

</script>


{% endblock scripts %}